import{_ as l,r as a,o as t,c,a as s,b as e,d as n,e as r}from"./app.d6e58541.js";const p={},d={id:"docker-\u6587\u6863",tabindex:"-1"},u=s("a",{class:"header-anchor",href:"#docker-\u6587\u6863","aria-hidden":"true"},"#",-1),b=n(" Docker \u6587\u6863 "),v=n("\u4ED3\u5E93\u4E2D\u5305\u542B\u4E86\u76F8\u5173\u6587\u4EF6\uFF0C\u53EF\u81EA\u884C\u6784\u5EFA\u8FD0\u884C\u3002"),m=s("br",null,null,-1),k=n(" \u6210\u54C1\u955C\u50CF "),h={href:"https://registry.hub.docker.com/repository/docker/catlair/bilitools",target:"_blank",rel:"noopener noreferrer"},g=s("code",null,"catlair/bilitools",-1),f=n("\uFF08\u73B0\u5728\u7684 Docker \u53EA\u662F\u5B89\u88C5\u4E86\u4E00\u4E2A npm \u5305\u800C\u5DF2\uFF0C\u5B58\u5728\u610F\u4E49\u4E0D\u5927\uFF09"),_=r(`<h2 id="\u914D\u7F6E\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a> \u914D\u7F6E\u6587\u4EF6</h2><p>\u652F\u6301\u73B0\u6210\u7684\u914D\u7F6E\u6587\u4EF6\uFF08<code>config/config.json</code>\uFF09\u548C gzip \u538B\u7F29\u540E\u7684\u914D\u7F6E\uFF08<code>config/config.txt</code>\uFF09<br> \u4F18\u5148\u52A0\u8F7D<strong>\u73AF\u5883\u53D8\u91CF</strong>\u4E2D\u7684 gzip \u538B\u7F29\u540E\u7684\u914D\u7F6E</p><details class="custom-container details"><summary>\u7B80\u5355\u4F8B\u5B50</summary><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span>
<span class="token function">mkdir</span> bilitools
<span class="token builtin class-name">cd</span> bilitools
<span class="token function">mkdir</span> config
<span class="token function">touch</span> config/config.json
<span class="token comment"># \u7136\u540E\u5C06\u914D\u7F6E\u653E\u5165 config.json \u4E2D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h3 id="\u672C\u5730\u914D\u7F6E\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u672C\u5730\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a> \u672C\u5730\u914D\u7F6E\u6587\u4EF6</h3><p>\u6302\u8F7D\u76EE\u5F55\u5373\u53EF\uFF0Cconfig \u4E3A\u914D\u7F6E\u76EE\u5F55\uFF0Clogs \u4E3A\u8FD0\u884C\u65E5\u5FD7\u76EE\u5F55\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token punctuation">\\</span>
    -v ~/bilitools/config:/usr/src/app/config <span class="token punctuation">\\</span>
    -v ~/bilitools/logs:/usr/src/app/logs <span class="token punctuation">\\</span>
    -i --rm catlair/bilitools:latest
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u538B\u7F29\u540E\u7684\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#\u538B\u7F29\u540E\u7684\u914D\u7F6E" aria-hidden="true">#</a> \u538B\u7F29\u540E\u7684\u914D\u7F6E</h3><p>\u4F7F\u7528\u73AF\u5883\u53D8\u91CF\u7684\u65B9\u5F0F</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token punctuation">\\</span>
    --env <span class="token assign-left variable">BILITOOLS_CONFIG</span><span class="token operator">=</span><span class="token string">&quot;xxxxxxxxxxxxx&quot;</span> <span class="token punctuation">\\</span>
    -v ~/bilitools/logs:/usr/src/app/logs <span class="token punctuation">\\</span>
    -i --rm  catlair/bilitools:latest
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u5B9A\u65F6\u8FD0\u884C" tabindex="-1"><a class="header-anchor" href="#\u5B9A\u65F6\u8FD0\u884C" aria-hidden="true">#</a> \u5B9A\u65F6\u8FD0\u884C</h2><p>\u66F4\u591A\u5185\u5BB9\u6B63\u5728\u5B8C\u5584\u4E2D\uFF0C\u4E34\u65F6\u65B9\u6848\u5982\u4E0B\uFF08\u5047\u8BBE\u4E0A\u9762\u7684\u5185\u5BB9\u5DF2\u7ECF\u6210\u529F\uFF09\uFF1A</p><p>\u521B\u5EFA\u4E00\u4E2A\u6587\u4EF6\uFF0C\u5185\u5BB9\u5982\u4E0B\uFF1A</p><details class="custom-container details"><summary>random_run.sh</summary><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token builtin class-name">set</span> -e
<span class="token keyword">function</span> <span class="token function-name function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token assign-left variable">min</span><span class="token operator">=</span><span class="token variable">$1</span><span class="token punctuation">;</span>
    <span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token variable">$2</span>-<span class="token variable">$1</span><span class="token punctuation">;</span>
    <span class="token assign-left variable">num</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s+10<span class="token comment">#%N</span><span class="token variable">)</span></span><span class="token punctuation">;</span>
    <span class="token variable"><span class="token punctuation">((</span>retnum<span class="token operator">=</span>num<span class="token operator">%</span>max<span class="token operator">+</span>min<span class="token punctuation">))</span></span><span class="token punctuation">;</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$retnum</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment"># \u65E7\u7684\u4E0D\u53BB\u65B0\u7684\u4E0D\u6765</span>
/usr/bin/docker pull catlair/bilitools:latest
<span class="token comment"># \u7B49\u5F85\u65F6\u95F4\u4E3A\u6267\u884C\u5F00\u59CB\u540E2s - 7200s\uFF082\u4E2A\u5C0F\u65F6\uFF09\u4E2D\u968F\u673A\u65F6\u95F4</span>
<span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token variable">$1</span>
<span class="token assign-left variable">b</span><span class="token operator">=</span><span class="token variable">$2</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token variable">$1</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token number">2</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token variable">$2</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token assign-left variable">b</span><span class="token operator">=</span><span class="token number">7200</span>
<span class="token assign-left variable">out</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>random $a $b<span class="token variable">)</span></span>s<span class="token punctuation">;</span>
<span class="token function">sleep</span> <span class="token variable">$out</span>
<span class="token comment"># \u6267\u884C (\u6CE8\u610F\u4FEE\u6539\u8DEF\u5F84)</span>
/usr/bin/docker run -v ~/bilitools/config:/usr/src/app/config -d --rm catlair/bilitools:latest
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">\xA0</div><br><br><br><br><br><br><br><br><div class="highlight-line">\xA0</div></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><div class="custom-container tip"><p class="custom-container-title">\u6CE8\u610F</p><p>\u65B0\u5EFA\u8FD9\u4E2A\u6587\u4EF6\u540E\uFF0C\u9700\u8981\u6267\u884C <code>chmod +x random_run.sh</code> \u8D4B\u4E88\u6587\u4EF6\u6267\u884C\u6743\u9650\u3002<br><code>/usr/bin/docker</code> \u662F\u6267\u884C <code>which docker</code> \u83B7\u53D6\u5230\u7684\uFF0C\u5982\u679C\u4E0D\u4E00\u6837\u8BF7\u4FEE\u6539\u3002<br><code>~/bilitools/config</code> \u8BF7\u6309\u7167\u9700\u6C42\u4FEE\u6539\u3002<br> \u7136\u540E\u6267\u884C <code>./random_run.sh 2 3</code> \u6765\u5C1D\u8BD5\u8FD0\u884C\uFF08\u540E\u9762\u7684 2 3 \u8868\u793A 2-3s \u5185\u968F\u673A\u65F6\u95F4\uFF0C\u9ED8\u8BA4 2-7200s \u5185\u968F\u673A\uFF09\u3002</p></div><p>\u8FD0\u884C <code>crontab -e</code> \u53EF\u4EE5\u6DFB\u52A0\u5B9A\u65F6\u4EFB\u52A1\uFF0C\u5982\u4E0B\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">5</span> <span class="token number">9</span> * * * <span class="token environment constant">$HOME</span>/bilitools/random_run.sh <span class="token number">2</span> <span class="token number">7200</span> <span class="token operator">&gt;&gt;</span> <span class="token environment constant">$HOME</span>/bilitools/logs/cron.log <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">\u6CE8\u610F</p><p>\u4EE5\u4E0B\u8BED\u53E5\u4E2D\u7684 <code>5 9 * * *</code> \u610F\u4E3A 09:05:00 \u6267\u884C\uFF0C\u6267\u884C <code>date</code> \u67E5\u770B\u7CFB\u7EDF\u5F53\u524D\u65F6\u95F4\u548C\u65F6\u533A\uFF08\u53EF\u80FD\u4F60\u5E76\u4E0D\u662F\u4E1C\u516B\u533A\uFF09\u3002<br> \u8DEF\u5F84\u8BB0\u5F97\u66F4\u6539\uFF08\u5982\u679C\u9700\u8981\uFF09\u3002<br> \u4E0D\u77E5 <code>crontab -e</code> \u600E\u4E48\u7528\uFF0C\u4F60\u53EF\u4EE5\u5C06\u4E0A\u9762\u547D\u4EE4\u653E\u5165\u6587\u4EF6 <code>my_crontab</code>\uFF0C\u7136\u540E\u6267\u884C <code>crontab my_crontab</code> \uFF08\u8FD9\u5C06\u8986\u76D6\u5DF2\u6709\u7684\u8BED\u53E5\uFF0C\u6240\u4EE5\u4E0D\u63A8\u8350\uFF09\u3002<br> \u5982\u679C\u6CA1\u6709\u542F\u52A8 crontab\uFF0C\u8BF7\u767E\u5EA6/\u8C37\u6B4C\u641C\u7D22 crontab \u542F\u52A8\uFF0Clinux \u5B58\u5728\u4E0D\u540C\uFF0C\u4F46\u6211\u80FD\u529B\u6709\u9650\uFF0C\u62B1\u6B49\u3002</p></div><p>\u6574\u4E2A\u6587\u4EF6\u7ED3\u6784\u53EF\u80FD\u5982\u4E0B\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>bilitools
    \u251C\u2500\u2500 config
    \u2502  \u2514\u2500\u2500 config.json
    \u251C\u2500\u2500 logs
    \u251C\u2500\u2500 my_crontab
    \u2514\u2500\u2500 random_run.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,19);function x($,y){const i=a("TestedVersion"),o=a("ExternalLinkIcon");return t(),c("div",null,[s("h2",d,[u,b,e(i,{type:"docker"})]),s("p",null,[v,m,k,s("a",h,[g,e(o)]),f]),_])}var V=l(p,[["render",x],["__file","docker.html.vue"]]);export{V as default};
